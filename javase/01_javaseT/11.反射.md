# 反射，主讲：汤小洋

## 一、简介

### 1. 类加载

​	将class文件读取到内存中的过程，称为类加载

​	class文件的加载由ClassLoader完成，称为类加载器

- 类加载器有三种类型：

  BootStrapClassLoader：启动类加载器，用C++语言编写的，由JVM在启动时加载初始化，主要负责加载%JAVA_HOME%/jre/lib路径下的类

  ExtClassLoader：扩展类加载器，由BootStrapClassLoader加载，主要负责加载%JAVA_HOME%/jre/lib/ext路径下的类  

  AppClassLoader：系统类加载器，由BootStrapClassLoader加载，主要负责加载classpath路径下的类（对于Eclipse就是项目路径/bin目录）  

- 可以使用`类名.class.getClassLoader()`获取当前类的类加载器

​        class文件读取到内存中会被封装成`java.lang.Class`类的对象

### 2. 反射

​	在程序运行状态中：

- 对于任意一个类，都能够获得这个类的所有属性和方法
- 对于任意一个对象，都能够调用它的任意一个属性和方法

​        这种在运行时动态的获取信息以及动态调用对象方法的功能称为反射 Reflection

### 3. 相关API

​	反射相关的类和接口位于`java.lang`包中

| 类/接口名   | 作用                 |
| ----------- | -------------------- |
| Class       | 表示运行中的类和接口 |
| Field       | 表示类的属性         |
| Method      | 表示类的方法         |
| Constructor | 表示类构造方法       |
| Package     | 表示类所属的包       |
| Modifier    | 表示访问修饰符       |
| Parameter   | 表示参数             |
| Annotation  | 表示注解             |

## 二、Class对象

### 1. 简介

​	运行中的class文件通过Class对象来表示		

- Class对象是在类加载时由JVM自动创建的，一个类在JVM中只会有一个Class对象
- Class类没有公共构造方法，不能自己创建Class对象，但可以获取其实例并进行操作
- Class对象是对Java类的抽象

​        Class是反射的核心类，要想操作类中的属性和方法，都必须从获取Class对象开始

### 2. 获取Class对象

​	三种方式：

1. 调用对象的getClass()方法
2. 调用类的class属性
3. 调用Class类的forName()静态方法

### 3. 常用方法



## 三、反射操作

### 1. 操作Field



### 2. 操作Method



### 3. 操作Constructor



## 四、注解

### 1. 简介

​	Annotation 注解是一种新的类型，与接口很相似，它与类、接口、枚举是在同一个层次

​	注解相当于是一种标记，以`@`开头， 一般写作 `@xxx`，可以声明在类、属性、方法、参数等的前面

​	用来对这些元素进行说明、标注或实现特定功能

### 2. JDK自带注解

​	在java.lang包中

| 注解                                   | 作用                                                       |
| -------------------------------------- | ---------------------------------------------------------- |
| @Override                              | 标记在方法前面，表示该方法是重写父类的方法                 |
| @Deprecated  [ˈdeprəkeɪtid] 不赞成     | 标记在类、属性、方法等前面，表示该内容已经过时，不建议使用 |
| @SuppressWarnings [səˈpres] 镇压、压制 | 标记在类、属性、方法等前面，用来关闭某些警告信息           |

### 3. 自定义注解

#### 3.1 定义注解

​	使用`@interface`关键字 + 元注解

​	语法：

```java
// 元注解
public @interface 注解名{
   // 抽象方法 
}
```

​	标记在注解上的注解，称为元注解

| 注解                       | 作用                                                         |
| -------------------------- | ------------------------------------------------------------ |
| @Target                    | 定义注解的作用域，即可以被标记在哪些元素前，通过枚举类ElementType来取值 |
| @Retention [rɪˈtenʃn] 保留 | 定义注解的生命周期，通过枚举类RetentionPolicy来取值          |
| @Documented                | 指定当使用javadoc生成API文档时包含该注解信息                 |
| @Inheried                  | 指定允许子类继承父类中的注解                                 |

#### 3.2 使用注解

​	语法：`@注解名(属性名=属性值,属性名=属性值)`

- 在使用注解时需要为注解中的抽象方法指定返回值，也称为：为注解指定属性值
- 属性名就是注解中抽象方法的名称

#### 3.3 解析注解

​	对于生命周期为运行期间（RetentionPolicy.RUNTIME）的注解，可以通过反射获得元素上的注解，实现特定的功能

### 4. 注解的应用

​	通过注解加载属性文件，为类中的属性赋值